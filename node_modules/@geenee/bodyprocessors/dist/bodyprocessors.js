import{FaceTracker as Q,PoseTracker as k}from'@geenee/bodytracking';import{Processor as K,Engine as y}from'@geenee/armature';var j=function(A,U){return j=Object['setPrototypeOf']||{'__proto__':[]}instanceof Array&&function(X,Z){X['__proto__']=Z;}||function(X,Z){for(var W in Z)Object['prototype']['hasOwnProperty']['call'](Z,W)&&(X[W]=Z[W]);},j(A,U);};function B(A,U){if('function'!=typeof U&&null!==U)throw new TypeError('Class\x20extends\x20value\x20'+String(U)+'\x20is\x20not\x20a\x20constructor\x20or\x20null');function X(){this['constructor']=A;}j(A,U),A['prototype']=null===U?Object['create'](U):(X['prototype']=U['prototype'],new X());}function G(A,U,X,Z){return new(X||(X=Promise))(function(W,d){function Y(I){try{x(Z['next'](I));}catch(H){d(H);}}function R(I){try{x(Z['throw'](I));}catch(H){d(H);}}function x(I){var H;I['done']?W(I['value']):(H=I['value'],H instanceof X?H:new X(function(b){b(H);}))['then'](Y,R);}x((Z=Z['apply'](A,U||[]))['next']());});}function J(A,U){var X,Z,W,d,Y={'label':0x0,'sent':function(){if(0x1&W[0x0])throw W[0x1];return W[0x1];},'trys':[],'ops':[]};return d={'next':R(0x0),'throw':R(0x1),'return':R(0x2)},'function'==typeof Symbol&&(d[Symbol['iterator']]=function(){return this;}),d;function R(x){return function(I){return function(H){if(X)throw new TypeError('Generator\x20is\x20already\x20executing.');for(;Y;)try{if(X=0x1,Z&&(W=0x2&H[0x0]?Z['return']:H[0x0]?Z['throw']||((W=Z['return'])&&W['call'](Z),0x0):Z['next'])&&!(W=W['call'](Z,H[0x1]))['done'])return W;switch(Z=0x0,W&&(H=[0x2&H[0x0],W['value']]),H[0x0]){case 0x0:case 0x1:W=H;break;case 0x4:return Y['label']++,{'value':H[0x1],'done':!0x1};case 0x5:Y['label']++,Z=H[0x1],H=[0x0];continue;case 0x7:H=Y['ops']['pop'](),Y['trys']['pop']();continue;default:if(!(W=Y['trys'],(W=W['length']>0x0&&W[W['length']-0x1])||0x6!==H[0x0]&&0x2!==H[0x0])){Y=0x0;continue;}if(0x3===H[0x0]&&(!W||H[0x1]>W[0x0]&&H[0x1]<W[0x3])){Y['label']=H[0x1];break;}if(0x6===H[0x0]&&Y['label']<W[0x1]){Y['label']=W[0x1],W=H;break;}if(W&&Y['label']<W[0x2]){Y['label']=W[0x2],Y['ops']['push'](H);break;}W[0x2]&&Y['ops']['pop'](),Y['trys']['pop']();continue;}H=U['call'](A,Y);}catch(b){H=[0x6,b],Z=0x0;}finally{X=W=0x0;}if(0x5&H[0x0])throw H[0x1];return{'value':H[0x0]?H[0x1]:void 0x0,'done':!0x0};}([x,I]);};}}var z=function(A){function U(){var X=null!==A&&A['apply'](this,arguments)||this;return X['faceTracker']=new Q(),X['cameraAngleBase']=0xa/0xb4*Math['PI'],X;}return B(U,A),U['prototype']['init']=function(X,Z,W){return G(this,void 0x0,void 0x0,function(){return J(this,function(d){switch(d['label']){case 0x0:return[0x4,this['faceTracker']['init'](null==X?void 0x0:X['root'],null==X?void 0x0:X['cache'])];case 0x1:return d['sent'](),[0x4,this['faceTracker']['prepare']()];case 0x2:return d['sent'](),[0x2,A['prototype']['init']['call'](this,X,Z,W)];}});});},U['prototype']['reset']=function(){this['faceTracker']['reset'](),A['prototype']['reset']['call'](this);},U['prototype']['dispose']=function(){this['faceTracker']['dispose']();},U['prototype']['process']=function(X,Z){return G(this,void 0x0,void 0x0,function(){var W,d,Y,R,x;return J(this,function(I){switch(I['label']){case 0x0:return[0x4,this['faceTracker']['process'](X,Z)];case 0x1:return W=I['sent'](),d=W['length']>0x0?W[0x0]:void 0x0,Y=d&&this['params']['transform']?this['faceTracker']['align'](d['keypoints']):void 0x0,R=Y&&this['params']['metric']?this['faceTracker']['metricPoints']():void 0x0,x=Y&&this['params']['backproj']?this['faceTracker']['backprojPoints']():void 0x0,[0x2,{'mesh':d,'transform':Y,'metric':R,'backproj':x}];}});});},U['prototype']['setupVideo']=function(X,Z){A['prototype']['setupVideo']['call'](this,X,Z),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['faceTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['faceTracker']['reset']();},U;}(K),E=function(A){function U(X){return A['call'](this,z,X)||this;}return B(U,A),U;}(y),w=function(A){function U(){var X=A['call'](this)||this;X['poseTracker']=new k(),X['cameraAngleBase']=0.25*Math['PI'];var Z=/iPhone|iPad|iPod/i['test'](navigator['userAgent']);return X['optimalSize']=Z?0x200:0x400,X;}return B(U,A),U['prototype']['init']=function(X,Z,W){return G(this,void 0x0,void 0x0,function(){return J(this,function(d){switch(d['label']){case 0x0:return[0x4,this['poseTracker']['init'](null==X?void 0x0:X['root'],null==X?void 0x0:X['cache'])];case 0x1:return d['sent'](),[0x4,this['poseTracker']['prepare']()];case 0x2:return d['sent'](),[0x2,A['prototype']['init']['call'](this,X,Z,W)];}});});},U['prototype']['reset']=function(){return this['poseTracker']['reset'](),A['prototype']['reset']['call'](this);},U['prototype']['dispose']=function(){this['poseTracker']['dispose']();},U['prototype']['process']=function(X,Z){return G(this,void 0x0,void 0x0,function(){var W;return J(this,function(d){switch(d['label']){case 0x0:return[0x4,this['poseTracker']['process'](X,Z)];case 0x1:return W=d['sent'](),[0x2,{'poses':W['map'](function(Y){return{'points':L['reduce'](function(R,x,I){return R[x]=Y['keypoints'][I],R;},{}),'score':Y['score'],'debug':Y['debug']};})}];}});});},U['prototype']['setupVideo']=function(X,Z){A['prototype']['setupVideo']['call'](this,X,Z),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['poseTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['poseTracker']['reset']();},U;}(K),f=function(A){function U(X){return A['call'](this,w,X)||this;}return B(U,A),U;}(y),L=['nose','eyeInnerL','eyeL','eyeOutterL','eyeInnerR','eyeR','eyeOutterR','earL','earR','mouthL','mouthR','shoulderL','shoulderR','elbowL','elbowR','wristL','wristR','pinkyL','pinkyR','indexL','indexR','thumbL','thumbR','hipL','hipR','kneeL','kneeR','ankleL','ankleR','heelL','heelR','footIndexL','footIndexR'];export{E as FaceEngine,z as FaceProcessor,f as PoseEngine,w as PoseProcessor};
